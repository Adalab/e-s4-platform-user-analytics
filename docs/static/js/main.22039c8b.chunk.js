(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,a){e.exports=a(31)},24:function(e,t,a){},28:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var r=a(0),s=a.n(r),n=a(16),l=a.n(n),i=(a(24),a(3)),c=a(4),u=a(6),o=a(5),m=a(7),d=a(2),h=a(35),_=a(34),p=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("header",{className:"app__header"},s.a.createElement("div",{className:"button__container"},s.a.createElement("div",{className:"div__btn btn",type:"button",onClick:this.props.onClick},s.a.createElement("i",{className:"zmdi zmdi-menu"}))),s.a.createElement("h1",{className:"app__header-title"}," ",s.a.createElement("span",{className:"span-style"},"Style"),s.a.createElement("span",{className:"span-sage"},"Sage"))))}}]),t}(r.Component),b=a(32),v=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"visibility",value:function(){return!0===this.props.hiddenButton?"hidden":"NO-hidden"}},{key:"render",value:function(){return s.a.createElement("aside",{className:"app__aside ".concat(this.visibility())},s.a.createElement("div",{className:"app__aside-header"},s.a.createElement("i",{className:"zmdi zmdi-chart"}),s.a.createElement("p",{className:"app__aside-title"},"User analytics")),s.a.createElement("ul",{className:"aside__list"},s.a.createElement("li",{className:"aside__item"},s.a.createElement(b.a,{to:"/",className:"aside__item-link"},"Overview")),s.a.createElement("li",{className:"aside__item"},s.a.createElement(b.a,{to:"/session-list",className:"aside__item-link"},"Session List")),s.a.createElement("li",{className:"aside__item"},s.a.createElement(b.a,{to:"/charts-usage",className:"aside__item-link"},"Charts Usage"))))}}]),t}(r.Component),E=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("h2",null,"Overview in progress...")}}]),t}(r.Component),f=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.getQueryUsername,a=e.resultsNumber;return s.a.createElement("div",{className:"search__container"},s.a.createElement("div",{className:"search__input-container"},s.a.createElement("label",{htmlFor:"username"}),s.a.createElement("span",{className:"icon__search"}," ",s.a.createElement("i",{className:"zmdi zmdi-search"})," "),s.a.createElement("input",{type:"text",id:"username",className:"search__input",placeholder:"search",name:"username",onKeyUp:t})),s.a.createElement("p",{className:"search__info-total"},"Showing ",a," entries"))}}]),t}(r.Component),N=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(o.a)(t).call(this,e))).state={row:""},a.mapResults=a.mapResults.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"mapResults",value:function(e){var t=this;return e.map(function(e,a){return s.a.createElement("tr",{className:"table__tr",key:a},s.a.createElement("td",{className:"table__td table__td--user"},e.user__username),s.a.createElement("td",{className:"table__td table__td--times"},t.props.renderTime(e.min_timestamp)),s.a.createElement("td",{className:"table__td table__td--sec"},t.renderDuration(e.duration_sec)),s.a.createElement("td",{className:"table__td table__td-req"},e.request_count))})}},{key:"renderDuration",value:function(e){var t=parseInt(e%60),a=parseInt(e/60),r=parseInt(a%60),s=parseInt(a/60);return 0!==s?s+"h"+r+"m"+t+"s":0!==r?r+"m"+t+"s":t+"s"}},{key:"render",value:function(){var e=this.props,t=e.sessionsList,a=e.orderResultsUsername,r=e.orderResultsTimeStarted,n=e.orderResultsDuration,l=e.orderResultsRequestCount;return s.a.createElement("table",{className:"table",id:"table"},s.a.createElement("thead",{className:"table__thead"},s.a.createElement("tr",{className:"table__tr-title"},s.a.createElement("th",{className:"table__th"},s.a.createElement("div",{className:"table__content"},s.a.createElement("p",{className:"table__title"},"Username"),s.a.createElement("div",{className:"table__icons"},s.a.createElement("i",{className:"zmdi zmdi-chevron-up","data-arrow":"up",onClick:a}),s.a.createElement("i",{className:"zmdi zmdi-chevron-down","data-arrow":"down",onClick:a})))),s.a.createElement("th",{className:"table__th"},s.a.createElement("div",{className:"table__content"},s.a.createElement("p",{className:"table__title"},"Times Started (local TZ)"),s.a.createElement("div",{className:"table__icons"},s.a.createElement("i",{className:"zmdi zmdi-chevron-up","data-arrow":"up",onClick:r}),s.a.createElement("i",{className:"zmdi zmdi-chevron-down","data-arrow":"down",onClick:r})))),s.a.createElement("th",{className:"table__th"},s.a.createElement("div",{className:"table__content"},s.a.createElement("p",{className:"table__title"},"Duration"),s.a.createElement("div",{className:"table__icons"},s.a.createElement("i",{className:"zmdi zmdi-chevron-up","data-arrow":"up",onClick:n}),s.a.createElement("i",{className:"zmdi zmdi-chevron-down","data-arrow":"down",onClick:n})))),s.a.createElement("th",{className:"table__th"},s.a.createElement("div",{className:"table__content"},s.a.createElement("p",{className:"table__title"},"Request Count"),s.a.createElement("div",{className:"table__icons"},s.a.createElement("i",{className:"zmdi zmdi-chevron-up","data-arrow":"up",onClick:l}),s.a.createElement("i",{className:"zmdi zmdi-chevron-down","data-arrow":"down",onClick:l})))))),s.a.createElement("tbody",{className:"table__tbody"},this.mapResults(t)))}}]),t}(r.Component),O=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(o.a)(t).call(this,e))).state={userData:[],activePetition:!1,queryUsername:"",sessionsList:[],duplicatedArray:!1,filter:"",resultsNumber:"0"},a.renderTime=a.renderTime.bind(Object(d.a)(Object(d.a)(a))),a.getQueryUsername=a.getQueryUsername.bind(Object(d.a)(Object(d.a)(a))),a.orderResultsUsername=a.orderResultsUsername.bind(Object(d.a)(Object(d.a)(a))),a.orderResultsTimeStarted=a.orderResultsTimeStarted.bind(Object(d.a)(Object(d.a)(a))),a.orderResultsDuration=a.orderResultsDuration.bind(Object(d.a)(Object(d.a)(a))),a.orderResultsRequestCount=a.orderResultsRequestCount.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchSessions()}},{key:"fetchSessions",value:function(){var e=this;fetch("http://adalab.stylesage.co/api/v1/sessions/").then(function(e){return e.json()}).then(function(t){e.setState({userData:t,sessionsList:t.sessions,duplicatedArray:!0,resultsDate:"",resultsNumber:""}),e.calculateResultsNumber(e.state.sessionsList),e.calculateFromToDate(e.state.userData)})}},{key:"calculateFromToDate",value:function(){var e=this.renderTime(this.state.userData.from_date)+" and "+this.renderTime(this.state.userData.to_date);this.setState({resultsDate:e})}},{key:"calculateResultsNumber",value:function(e){var t=parseInt(e.length)+"/"+parseInt(this.state.userData.sessions.length);this.setState({resultsNumber:t})}},{key:"addZero",value:function(e){return e.length<2&&(e="0"+e),e}},{key:"renderTime",value:function(e){var t=new Date(e);return t.getFullYear()+"-"+this.addZero((t.getMonth()+1).toString())+"-"+this.addZero(t.getDate().toString())+","+this.addZero(t.getHours().toString())+":"+this.addZero(t.getMinutes().toString())}},{key:"filterUserame",value:function(e){return this.state.userData.sessions.filter(function(t){return t.user__username.includes(e)})}},{key:"getQueryUsername",value:function(e){var t=e.currentTarget.value,a=this.filterUserame(t),r="";switch(this.state.filter){case"Username-up":r=this.orderUsername(a);break;case"Username-down":r=this.orderUsername(a).reverse();break;case"TimeStarted-up":r=this.orderTimeStarted(a);break;case"TimeStarted-down":r=this.orderTimeStarted(a).reverse();break;case"Duration-up":r=this.orderDuration(a);break;case"Duration-down":r=this.orderDuration(a).reverse();break;case"RequestCount-up":r=this.orderRequestCount(a);break;case"RequestCount-down":r=this.orderRequestCount(a).reverse();break;default:r=a}this.calculateResultsNumber(r),this.setState({queryUsername:t,sessionsList:r})}},{key:"orderUsername",value:function(e){return e.sort(function(e,t){var a=e.user__username.toUpperCase(),r=t.user__username.toUpperCase();return a<r?-1:a>r?1:0})}},{key:"orderResultsUsername",value:function(e){var t=this.orderUsername(this.state.sessionsList);"down"===e.currentTarget.getAttribute("data-arrow")?this.setState({sessionsList:t.reverse(),filter:"Username-down"}):this.setState({sessionsList:t,filter:"Username-up"})}},{key:"orderTimeStarted",value:function(e){return e.sort(function(e,t){return new Date(e.min_timestamp)-new Date(t.min_timestamp)})}},{key:"orderResultsTimeStarted",value:function(e){var t=this.orderTimeStarted(this.state.sessionsList);"down"===e.currentTarget.getAttribute("data-arrow")?this.setState({sessionsList:t.reverse(),filter:"TimeStarted-down"}):this.setState({sessionsList:t,filter:"TimeStarted-up"})}},{key:"orderDuration",value:function(e){return e.sort(function(e,t){return e.duration_sec-t.duration_sec})}},{key:"orderResultsDuration",value:function(e){var t=this.orderDuration(this.state.sessionsList);"down"===e.currentTarget.getAttribute("data-arrow")?this.setState({sessionsList:t.reverse(),filter:"Duration-down"}):this.setState({sessionsList:t,filter:"Duration-up"})}},{key:"orderRequestCount",value:function(e){return e.sort(function(e,t){return e.request_count-t.request_count})}},{key:"orderResultsRequestCount",value:function(e){var t=this.orderRequestCount(this.state.sessionsList);"down"===e.currentTarget.getAttribute("data-arrow")?this.setState({sessionsList:t.reverse(),filter:"RequestCount-down"}):this.setState({sessionsList:t,filter:"RequestCount-up"})}},{key:"render",value:function(){var e=this.state,t=e.sessionsList,a=e.duplicatedArray,r=e.resultsDate,n=e.resultsNumber;return s.a.createElement("div",{className:"app__container"},s.a.createElement("main",{className:"app__main"},s.a.createElement("div",{className:"breadcrumb__container"},s.a.createElement("ul",{className:"breadcrumb__container-list"},s.a.createElement("li",{className:"breadcrumb__container-item"},s.a.createElement(b.a,{to:"/",className:"breadcrumb__link"},"Overview")),">",s.a.createElement("li",{className:"breadcrumb__container-item"},s.a.createElement("span",null,"Sessions")))),s.a.createElement("div",{className:"panel__session"},s.a.createElement("i",{className:"zmdi zmdi-apps"}),s.a.createElement("h2",{className:"panel__session-title"},"Sessions between ",r)),s.a.createElement(f,{getQueryUsername:this.getQueryUsername,resultsNumber:n}),s.a.createElement("div",{className:"table__container"},0!==a.length?s.a.createElement(N,{renderTime:this.renderTime,orderResultsUsername:this.orderResultsUsername,orderResultsTimeStarted:this.orderResultsTimeStarted,orderResultsDuration:this.orderResultsDuration,orderResultsRequestCount:this.orderResultsRequestCount,sessionsList:t}):s.a.createElement("p",null,"Looking for data..."))))}}]),t}(r.Component),k=a(14),y=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"chartNames",value:function(){var e=this.props,t=e.renderTimesUsed,a=e.renderTimesPercentage,r=e.renderChartUsers;return this.props.chartNames.map(function(e,n){return s.a.createElement("tr",{className:"table__tr",key:n},s.a.createElement("td",{className:"table__td"},e),s.a.createElement("td",{className:"table__td"},t(e)),s.a.createElement("td",{className:"table__td"},a(t(e))),s.a.createElement("td",{className:"table__td"},r(e)))})}},{key:"render",value:function(){return s.a.createElement("table",{className:"table",id:"table"},s.a.createElement("thead",{className:"table__thead"},s.a.createElement("tr",{className:"table__tr-title"},s.a.createElement("th",{className:"table__th"},s.a.createElement("p",{className:"table__title"},"Chart")),s.a.createElement("th",{className:"table__th"},s.a.createElement("p",{className:"table__title"},"Times Used")),s.a.createElement("th",{className:"table__th"},s.a.createElement("p",{className:"table__title"},"%")),s.a.createElement("th",{className:"table__th"},s.a.createElement("p",{className:"table__title"},"Users")))),s.a.createElement("tbody",{className:"table__tbody"},this.chartNames()))}}]),t}(r.Component),g=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(o.a)(t).call(this,e))).state={userData:[],chartList:[],chartNames:[],allGroupsList:[],groupsList:[],filterOptionsChecked:!0,timelapse:7,fromDate:new Date,toDate:new Date,userGroupsInputs:null},a.renderTimesUsed=a.renderTimesUsed.bind(Object(d.a)(Object(d.a)(a))),a.renderTimesPercentage=a.renderTimesPercentage.bind(Object(d.a)(Object(d.a)(a))),a.renderChartUsers=a.renderChartUsers.bind(Object(d.a)(Object(d.a)(a))),a.filterOptions=a.filterOptions.bind(Object(d.a)(Object(d.a)(a))),a.handleOptions=a.handleOptions.bind(Object(d.a)(Object(d.a)(a))),a.handleChangeDate=a.handleChangeDate.bind(Object(d.a)(Object(d.a)(a))),a.handleDateFrom=a.handleDateFrom.bind(Object(d.a)(Object(d.a)(a))),a.handleDateTo=a.handleDateTo.bind(Object(d.a)(Object(d.a)(a))),a.handleUserGroups=a.handleUserGroups.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchCharts(this.state.timelapse)}},{key:"fetchCharts",value:function(e){var t,a,r=this,s=new Date,n=(new Date).setDate(s.getDate()-e);n=new Date(n).toISOString(),s=new Date(s).toISOString(),(t=n,a=s,fetch("".concat("http://adalab.stylesage.co/api/v1/charts/","?from_date=").concat(t,"&to_date=").concat(a)).then(function(e){return e.json()})).then(function(e){r.setState({chartList:e.open_chart_events,userData:e}),r.filterOptions(r.state.filterOptionsChecked,e.open_chart_events),r.renderChartList(e.open_chart_events),r.renderUserGroups(e.open_chart_events)})}},{key:"renderChartList",value:function(e){var t=e.map(function(e){return e.details.chart_name}).sort(function(e,t){return e>t?1:e<t?-1:0});this.setState({chartNames:Object(k.a)(new Set(t))})}},{key:"renderTimesUsed",value:function(e){return this.state.chartList.reduce(function(t,a){return a.details.chart_name===e&&t++,t},0)}},{key:"renderTimesPercentage",value:function(e){return(e/this.state.chartList.length*100).toFixed(1)}},{key:"renderChartUsers",value:function(e){var t=this.state.chartList.filter(function(t){return t.details.chart_name===e}).map(function(e){return e.request.user__username});return Object(k.a)(new Set(t)).length}},{key:"renderUserGroups",value:function(e){var t=this,a=e.map(function(e){return e.request.user__group__name}),r=Object(k.a)(new Set(a)),n=r.sort(function(e,t){var a=e.toLowerCase(),r=t.toLowerCase();return a>r?1:a<r?-1:0}).map(function(e,a){return s.a.createElement("li",{key:a},s.a.createElement("label",{htmlFor:e},s.a.createElement("input",{onChange:t.handleUserGroups,id:e,type:"checkbox",value:e,name:e,defaultChecked:!0}),e))});this.setState({allGroupsList:r,groupsList:r,userGroupsInputs:n})}},{key:"filterOptions",value:function(e,t){var a=t.filter(function(t){return e?!t.request.user__username.includes("stylesage"):t});this.setState({chartList:a})}},{key:"handleOptions",value:function(e){var t=e.currentTarget.checked,a=this.state.userData.open_chart_events;this.setState({filterOptionsChecked:t}),this.filterOptions(t,a)}},{key:"handleDateTo",value:function(e){var t=this;e.persist(),this.setState({toDate:e.currentTarget.value},function(){return t.handleChangeDate(e)})}},{key:"handleDateFrom",value:function(e){var t=this;e.persist(),this.setState({fromDate:e.currentTarget.value},function(){return t.handleChangeDate(e)})}},{key:"handleChangeDate",value:function(e){var t,a=new Date,r=new Date;switch(e.currentTarget&&(t=e.currentTarget.value),t){case"last-week":r.setDate(r.getDate()-7);break;case"last-month":r.setMonth(r.getMonth()-1);break;case"last-two-months":r.setMonth(r.getMonth()-2);break;case"always":r=new Date(2015,0,1,0,0);break;default:a=new Date(this.state.toDate),r=new Date(this.state.fromDate)}var s=Math.round((a-r)/864e5);this.setState({timelapse:s}),this.fetchCharts(s)}},{key:"handleUserGroups",value:function(e){var t=e.currentTarget.value,a=this.state.groupsList;e.currentTarget.checked?a.push(t):a.splice(t,1),this.setState({groupsList:a}),this.filterUserGroups(a)}},{key:"filterUserGroups",value:function(e){var t=this.state.userData.open_chart_events.filter(function(t){for(var a=e.map(function(e){return t.request.user__group__name===e}),r=!1,s=0;s<a.length;s++)!0===a[s]&&(r=!0);return r});this.setState({chartList:t}),this.filterOptions(this.state.filterOptionsChecked,t)}},{key:"render",value:function(){var e=this.state,t=e.chartNames,a=e.userGroupsInputs;return s.a.createElement("div",{className:"app__container"},s.a.createElement("main",{className:"app__main"},s.a.createElement("div",{className:"breadcrumb__container"},s.a.createElement("ul",{className:"breadcrumb__container-list"},s.a.createElement("li",{className:"breadcrumb__container-item"},s.a.createElement(b.a,{to:"/",className:"breadcrumb__link"},"Overview")),">",s.a.createElement("li",{className:"breadcrumb__container-item"},s.a.createElement("span",null,"ChartsUsage")))),s.a.createElement("div",{className:"charts__container"},s.a.createElement("div",{className:"table__container"},s.a.createElement(y,{chartNames:t,renderTimesUsed:this.renderTimesUsed,renderTimesPercentage:this.renderTimesPercentage,renderChartUsers:this.renderChartUsers})),s.a.createElement("div",{className:"chart__filters"},s.a.createElement("div",{className:"chart__filter chart__filter-options"},s.a.createElement("div",{className:"chart__filter-header"},s.a.createElement("i",{className:"zmdi zmdi-account-add"}),s.a.createElement("h3",{className:"chart__filter-title"},"OPTIONS")),s.a.createElement("div",{className:"chart__filter-content"},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",onClick:this.handleOptions,defaultChecked:!1})," exclude support users (x@stylesage.com)"))),s.a.createElement("div",{className:"chart__filter chart__filter-range"},s.a.createElement("div",{className:"chart__filter-header"},s.a.createElement("i",{className:"zmdi zmdi-calendar-check"}),s.a.createElement("h3",{className:"chart__filter-title"},"DATE RANGE")),s.a.createElement("div",{className:"chart__filter-content"},s.a.createElement("p",null," From: | To:"),s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"last-week"},s.a.createElement("input",{defaultChecked:!0,onClick:this.handleChangeDate,type:"radio",id:"last-week",name:"date",value:"last-week",className:"input__type-radio"}),"last week")),s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"last-month"},s.a.createElement("input",{onClick:this.handleChangeDate,type:"radio",id:"last-month",name:"date",value:"last-month",className:"input__type-radio"}),"last month")),s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"last-two-months"},s.a.createElement("input",{onClick:this.handleChangeDate,type:"radio",id:"last-two-months",name:"date",value:"last-two-months",className:"input__type-radio"}),"last 2 months")),s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"last-two-months"},s.a.createElement("input",{onClick:this.handleChangeDate,type:"radio",id:"set-date",name:"date",value:"set-date",className:"input__type-radio"}),"set date")),s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"from-date"},s.a.createElement("input",{onChange:this.handleDateFrom,id:"from-date",type:"date",name:"date??"}),"from date")),s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"to-date"},s.a.createElement("input",{onChange:this.handleDateTo,id:"to-date",type:"date",name:"date??"}),"to date")),s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"always"},s.a.createElement("input",{onClick:this.handleChangeDate,type:"radio",id:"always",name:"date",value:"always",className:"input__type-radio"}),"always")))),s.a.createElement("div",{className:"chart__filter chart__filter-groups"},s.a.createElement("div",{className:"chart__filter-header"},s.a.createElement("i",{className:"zmdi zmdi-accounts"}),s.a.createElement("h3",{className:"chart__filter-title"},"USER GROUPS")),s.a.createElement("div",{className:"chart__filter-content"},s.a.createElement("p",null,"select all | select active | clear all"),s.a.createElement("ul",{className:"chart__filter-listgroups"},a||"")))))))}}]),t}(r.Component),j=(a(28),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(o.a)(t).call(this,e))).state={hiddenButton:!0},a.handleClick=a.handleClick.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"handleClick",value:function(){var e=!0!==this.state.hiddenButton;this.setState({hiddenButton:e})}},{key:"render",value:function(){return s.a.createElement("div",{className:"app"},s.a.createElement(p,{onClick:this.handleClick}),s.a.createElement("div",{className:"page__wrapper"},s.a.createElement(v,{hiddenButton:this.state.hiddenButton}),s.a.createElement(h.a,null,s.a.createElement(_.a,{exact:!0,path:"/",render:function(){return s.a.createElement(E,null)}}),s.a.createElement(_.a,{path:"/session-list",render:function(){return s.a.createElement(O,null)}}),s.a.createElement(_.a,{path:"/charts-usage",render:function(){return s.a.createElement(g,null)}}))))}}]),t}(r.Component)),C=a(33);l.a.render(s.a.createElement(C.a,null,s.a.createElement(j,null)),document.getElementById("root"))}},[[18,2,1]]]);
//# sourceMappingURL=main.22039c8b.chunk.js.map